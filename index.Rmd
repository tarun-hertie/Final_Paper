---
title: "Renewable Energy: What do explain the adoption of solar and wind power in European countries?"
author: Camila & Tarun
output: flexdashboard::flex_dashboard
vertical_layout: fill
---

Inputs {.sidebar}
---------------------------------

Traditional energy sources like coal, oil and natural gas, have contributed to high levels of pollution and greenhouse gas emissions worldwide.

One potential way of removing the impact of greenhouse gas emission is mitigation â€“ that is, activities intended to reduce the magnitude of climate change and its impact on human life. 

The shift to cleaner forms of energy production through the adoption of renewable energy sources is a key mitigation strategy for countries like India and China. 

What about the European countries? Are they also shifting their energy sources to renewable ones? What do explain the adoption of renewable energy in European countries?


Column
---------------------------------

### What are the renewable energy consumption levels across EU countries? 

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE, type = 'html', results='asis'}

setwd("~/Desktop/CollaborativeDataMethods/VieiraKhanna_Assignment3/data_cleaning")

# Importing and cleaning data from Eurostat
source('Eurostat_and_Opec_data.R')

# Importing and cleaning data from World Bank
source('WDI_data.R')

# Merging the data
re_data <- merge(Combined_WDI,Combine_EuroStat,by = c("country", "year"), all.x = T, all.y = T)

# Remove missing values
re_data1 <- na.omit(re_data)

#creating var for solar and wind gen as percent of total elec consumption
re_data1$sw_pc_elec <- re_data1$re_gen/re_data1$elec_total*100 
re_data_map <- re_data1[which(re_data1$year == "2013"),]

library(googleVis)
# Plot
re_map <- gvisGeoChart(re_data_map, locationvar = 'country',
                      colorvar = 'sw_pc_elec',
                      options = list(
                        colors = "['#f7fcb9', '#31a354']",
                        region ="150"
                          ))
plot(re_map)

```

### Solar and Wind Power Trends

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE}

#var. of RE electricity consumption across countries
re_data1$sw_rise <- unlist(
        tapply(re_data1$sw_pc_elec, re_data1$country, function(x) c(NA,100*diff(x)/x[-length(x)])))

library(reshape2)
library(plotly)

re_data2 <- re_data1[order(re_data1$year,re_data1$sw_rise),] #arranging data
countries10 <- tail(re_data2,10)[1] %>% as.matrix() %>% as.character() %>% paste(collapse = "|") #finding top10
uptake_changes <- filter(re_data2, grepl(countries10, country))


percent_change <- ggplot(data = uptake_changes,
       aes(x = year, y = sw_rise, group = country,colour = country)) +
    geom_line() +
    geom_point() +
        xlab(label = "\nYear") +
        ylab(label = "% change in RE uptake\n")

ggplotly(percent_change)
   

#library(ggplot2)
#re_data1 <- re_data1[order(re_data1$year,re_data1$wind_gen),] #arranging data
#countries10 <- tail(re_data1,10)[1] %>% as.matrix() %>% as.character() %>% paste(collapse = "|") #finding top10
#re_wind_top10  <- filter(re_data, grepl(countries10, country))

#Colours <- c('#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5','#80cdc1','#35978f','#01665e','#003c30')

#w_power <- ggplot(data = na.omit(re_wind_top10)) + 
 #       aes(x = year, y = wind_gen, group = country, fill = country) + #geom_area(position = "stack") + 
#scale_color_manual(values = Colours) +
#xlab("\nYear") +
#ylab("Wind Energy Generation(TWh)\n") +
#ggtitle("Wind Energy Generation in ten largest wind energy markets in Europe\n") +
#theme_bw(base_size = 10)
#rm(list = c("re_wind_top10", "countries10"))

#library(plotly)
#ggplotly(w_power)

```


Column {data-width=500}
---------------------------------

### The impact of oil prices...

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE}

# Creation of a new data frame subset + sum of RE elect. generation in each year for all countries
#re_data2 <- aggregate(re_data1$re_gen, list(re_data1$year), FUN=sum)
#class(re_data2)


#Percentage changes in RE generation from 2005 until 2013
#re_data2$re_gen_pct <- unlist(tapply(re_data2$x, re_data2$Group.1, function(x) #c(NA,100*diff(x)/x[-length(x)])))


#For oil_pc
#df2 <- re_data1(year, country, oil_price)
#DT[1:9,]

#oil_pc <- 

#re_data1$re_gen_sum <-aggregate(x = re_data1[c("re_gen")], FUN = sum, by = list(Group.date = re_data1$year))

#Dashed <-  gvisLineChart(df, xvar="year", yvar=c("oil_pc","re_gen_pc"),
 #                       options=list(
  #                        series="[{color:'green', targetAxisIndex: 0, 
   #                       lineWidth: 1, lineDashStyle: [2, 2, 20, 2, 20, 2]}, 
    #                      {color: 'blue',targetAxisIndex: 1, 
     #                     lineWidth: 2, lineDashStyle: [4, 1]}]",
      #                    vAxes="[{title:'% change in RE Generation'}, {title:'% #change in oil prices'}]"
 #                       ))
#plot(Dashed)

```

### ... and other factors in renewable energy uptake.

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE}

#myStateSettings <- '\n{"iconType":"LINE", "dimensions":{
 #   "iconDimensions":["dim0"]},"xAxisOption":"_TIME",
  #  "orderedByX":false,"orderedByY":false,"yZoomedDataMax":100}\n'
#plot(gvisMotionChart(Fruits, "Fruit", "Year", 
 #     options=list(state=myStateSettings, height=320)))


