---
title: "Renewable Energy: What factors explain the adoption of solar and wind power in EU countries?"
author: Camila & Tarun
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
---

Inputs {.sidebar}
---------------------------------

Traditional energy sources like coal, oil and natural gas, have contributed to high levels of pollution and greenhouse gas emissions worldwide.

One potential way of removing the impact of greenhouse gas emission is mitigation â€“ that is, activities intended to reduce the magnitude of climate change and its impact on human life.

The shift to cleaner forms of energy production through the adoption of renewable energy sources is a key mitigation strategy for countries like India and China.

What about the European countries? Are they also switching to renewable energy? What factors explain the adoption of renewables - wind and solar - in European countries?

Column
-----------------------

###What percentage of total electricity consumption in EU countries can be attributed to Renewable Energy?

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE, type = 'html', results='asis', cache=TRUE}

setwd("~/Desktop/CollaborativeDataMethods/VieiraKhanna_Assignment3/data_cleaning")

# Importing and cleaning data from Eurostat
source('Eurostat_and_Opec_data.R')

# Importing and cleaning data from World Bank
source('WDI_data.R')

# Merging the data
re_data <- merge(Combined_WDI,Combine_EuroStat,by = c("country", "year"), all.x = T, all.y = T)

# Remove missing values
re_data1 <- na.omit(re_data)

#creating var for solar and wind gen as percent of total elec consumption
re_data1$sw_pc_elec <- re_data1$re_gen/re_data1$elec_total*100 
re_data_map <- re_data1[which(re_data1$year == "2013"),]

library(googleVis)
# Plot
re_map <- gvisGeoChart(re_data_map, locationvar = 'country',
                      colorvar = 'sw_pc_elec',
                      options = list(
                        colors = "['#f7fcb9', '#31a354']",
                        region ="150"
                          ))
print(re_map, tag = 'chart')
```

###Wind Power Trend 

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE, type = 'html', results='asis'}

library(ggplot2)
library(dplyr)
library(plotly)

#selecting data for wind
re_data1 <- re_data1[order(re_data1$year,re_data1$wind_gen),] #arranging data
countries10 <- tail(re_data1,10)[1] %>% as.matrix() %>% as.character() %>% paste(collapse = "|") #finding top10
re_wind_top10  <- filter(re_data, grepl(countries10, country)) #selecting top 10 countries by generation 

#create graph of Wind Generation
Colours <- c('#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5','#80cdc1',
             '#35978f','#01665e','#003c30') # assigning colour pallette

wind_chart <- ggplot(data = na.omit(re_wind_top10)) + 
  aes(x = year, y = wind_gen, group = country, fill = country) +
  geom_area(position = "stack") + 
  scale_color_manual(values = Colours) +
  xlab("\nYear") +
  ylab("Wind Energy Generation(TWh)\n") +
  ggtitle("\nWind Energy Generation in ten largest wind energy markets in Europe\n") +
  theme_bw(base_size = 10)

ggplotly(wind_chart)

```

Column
----------------------------

### From the current levels of electricity consumption in EU...
...Select on the left side the factors that may impact the uptake of RE. On the right, check the countries for further info. See how things evolve by changing the time slider located at the the bottom.

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE, type = 'html', results='asis'}

library(googleVis)

myState <- '\n{"time":"2013","orderedByX":true,"xZoomedDataMax":26,"nonSelectedAlpha":0.4,"sizeOption":"_UNISIZE","duration":{"multiplier":1,"timeUnit":"Y"},"uniColorForNonSelected":false,"iconKeySettings":[],"xZoomedDataMin":0,"iconType":"VBAR","yZoomedIn":false,"xZoomedIn":false,"xLambda":1,"showTrails":false,"xAxisOption":"11","yZoomedDataMax":40,"yZoomedDataMin":0,"orderedByY":false,"yAxisOption":"11","colorOption":"_UNIQUE_COLOR","dimensions":{"iconDimensions":["dim0"]},"playDuration":15000,"yLambda":1}\n'

re_data1$year <- as.numeric(re_data1$year)
M <-  gvisMotionChart(data=re_data1, idvar="country", timevar="year", chartid="re_all_var", options=list(width=650, height=350, state=myState))
print(M,  tag = 'chart')

```

###Does RE generation follow changes in oil prices?

```{r, include=T, message=F, warning=FALSE, error=FALSE, echo=FALSE, type = 'html', results='asis'}

# Var. in RE generation
# Creation of a new data frame subset + sum of RE elect. generation in each year for all countries
re_data2 <- aggregate(re_data1$re_gen, list(re_data1$year), FUN=sum)
names(re_data2)[names(re_data2) == 'x'] <- 're_gen_sum'
names(re_data2)[names(re_data2) == 'Group.1'] <- 'year'

#Percentage changes in RE generation from 2005 until 2013
re_data2$re_gen_pct <- c(NA, 17.93, 27.53, 17.38, 15.80, 16.80, 30.69, 21.54, 16.15)

#Var. in Oil prices
re_data2$oil_pct <- c(NA, 20.61, 13.09, 36.72, -35.35, 26.84, 38.74, 1.85, -3.27)

library(googleVis)
#Plotting graph
Dashed <-  gvisLineChart(re_data2, xvar = 'year', yvar=c('re_gen_pct','oil_pct'),
                         options=list(series="[{color:'green', targetAxisIndex: 0, 
                         lineWidth: 1, lineDashStyle: [2, 2, 20, 2, 20, 2]}, 
                         {color: 'blue',targetAxisIndex: 1, 
                         lineWidth: 2, lineDashStyle: [4, 1]}]",
                                 vAxes="[{title:'% change in RE Generation'}, {title:'% change in oil prices'}]"
                         ))

print(Dashed, tag = 'chart')
```

